# ğŸ‘‘TEAM: AI ë°˜ë„ì²´ ì„¤ê³„ 2ê¸° 4ë²ˆì§¸ ìˆ˜ì—… 2ì¡°


## ğŸ™‹â€â™‚ï¸íŒ€ì›

|                                                 **ìµœìœ¤ì„**                                                 |                                                                                                                             **ë°°ìƒì›**                                                                                                                              |                                                                        **ìœ¤ì˜ë¹ˆ**                                                                        |                                                                                                                             **ì •ì€ì§€**                                                                                                                              |
| :--------------------------------------------------------------------------------------------------------: | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: | :------------------------------------------------------------------------------------------------------------------------------------------------------: | :-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: |
|                                                Team Leader                                                 |                                                                                                                            Team member 1                                                                                                                             |                                                                  Team member 2                                                                   |                                                                                                                         Team member 3                                                                                                                        |
| [<img src="/History/img/profile_1.png" width=150 height=150> </br> @ìµœìœ¤ì„](https://github.com/stockfail) | [<img src="/History/img/profile_2.jpg" width=150 height=150> </br> @Bae Sangwon](https://github.com/BAESANGWON1) | [<img src="/History/img/profile_3.jpg" width=150 height=150> </br> @ìœ¤ì˜ë¹ˆ](https://github.com/demic2da) | [<img src="/History/img/profile_4.jpg" width=150 height=150> </br> @Jung Eunji](https://github.com/2735C) |

## ğŸ–Šï¸Role

### ğŸ¶ìµœìœ¤ì„
- Team leader
- BFP-based FFT Fixed point modeling
- Butterfly Calculation Module RTL Desgin 
- Gate simulation testbench design & Gate simulation


### ğŸ§ë°°ìƒì›
- BFP-based FFT Fixed point modeling
- Butterfly Calculation Module RTL Desgin 
- Gate simulation & Debugging


### ğŸ»ìœ¤ì˜ë¹ˆ
- BFP-based FFT Fixed point modeling
- Butterfly Calculation Module & Bit reverse RTL Desgin 
- Gate simulation & Debugging
- FPGA targeting



### ğŸ¤ì •ì€ì§€ 
- BFP-based FFT Fixed point modeling
- CBFP Module RTL Desgin 
- Gate simulation & Debugging
- FPGA targeting


## ğŸš€í”„ë¡œì íŠ¸ ê°œìš”[[ì—°êµ¬ ë°°ê²½]](/History/Progress_report/overview.md)

ë³¸ í”„ë¡œì íŠ¸ì—ì„œëŠ” **BFP(Block Floating Point) ê¸°ë°˜ Radix-2Â² êµ¬ì¡°ì˜ FFT**ë¥¼ ëŒ€ìƒìœ¼ë¡œ MATLAB í™˜ê²½ì—ì„œ Floating ëª¨ë¸ì„ **Q-format ê¸°ë°˜ Fixed-point ëª¨ë¸ë¡œ ë³€í™˜**í•˜ì—¬ **ì•Œê³ ë¦¬ì¦˜ ìˆ˜ì¤€ì˜ ì‚¬ì „ ê²€ì¦(High-level verification)** ì„ ìˆ˜í–‰í•˜ì˜€ë‹¤. ì´ì–´ì„œ CBFP(Combined Block Floating Point) ëª¨ë¸ì˜ Fixed-point êµ¬í˜„ì„ ì ìš©í•˜ì—¬ **BFPì™€ CBFP ì•Œê³ ë¦¬ì¦˜ ê°„ ì„±ëŠ¥ì„ ë¹„êµ**í•˜ì˜€ë‹¤.

CBFP ëª¨ë¸ì„ ê¸°ë°˜ìœ¼ë¡œ **RTL ì„¤ê³„ ë° í•©ì„±**ì„ ì§„í–‰í•˜ê³ , ì´ë¥¼ í†µí•´ **setup time violation, Area, Latency** ë“±ì˜ íŠ¹ì„±ì„ ë¶„ì„í•˜ì˜€ë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ **ê²Œì´íŠ¸ ë ˆë²¨ ì‹œë®¬ë ˆì´ì…˜**ê³¼ **FPGA Targeting**ì„ ìˆ˜í–‰í•˜ì—¬ RTL ì„¤ê³„ì˜ ê¸°ëŠ¥ì  íƒ€ë‹¹ì„±ì„ ê²€ì¦í•˜ì˜€ë‹¤.

## ğŸ’»ê°œë°œ í™˜ê²½ <br>

- **ëª¨ë¸ë§ ë° ì•Œê³ ë¦¬ì¦˜ ì„¤ê³„**
  - MATLAB (Floating/Fixed-point ëª¨ë¸ë§ ë° High-level verification)

- **ì‹œë®¬ë ˆì´ì…˜ ë° ê²€ì¦**
  - Synopsys VCS (RTL ë° ê²Œì´íŠ¸ ë ˆë²¨ ë…¼ë¦¬ ì‹œë®¬ë ˆì´ì…˜)
  - Synopsys Verdi (íŒŒí˜• ë¶„ì„ ë° ë””ë²„ê¹…)

- **ê°œë°œ íˆ´ ë° í¸ì§‘ê¸°**
  - MobaXterm (ì›ê²© ê°œë°œ í™˜ê²½)
  - Visual Studio Code (RTL ë° ìŠ¤í¬ë¦½íŠ¸ í¸ì§‘)

- **í•©ì„± ë° ê²Œì´íŠ¸ ì‹œë®¬ë ˆì´ì…˜**
  - Synopsys Design Compiler (í•©ì„±)
  - Synopsys VCS/Verdi (ê²Œì´íŠ¸ ë ˆë²¨ ì‹œë®¬ë ˆì´ì…˜)

- **FPGA íƒ€ê²ŸíŒ…**
  - Xilinx Vivado (Bitstream ìƒì„± ë° FPGA êµ¬í˜„)

- **í•˜ë“œì›¨ì–´ í”Œë«í¼**
  - Avnet UltraZed-7EV Carrier Card


## ğŸ—“ï¸ê°œë°œ ì¼ì • [[ìƒì„¸ ì¼ì •]](/History/Progress_report/schedule.md)

### <ê°œë°œì¼ì • ê¸°ì¬ - Gantt Chart>

|                            |  7/18  |  7/19  |  7/20  |  7/21  |  7/22  |  7/23  |  7/24~7/30  |  7/31~8/3  | 8/4  | 
| :---------------------      | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| BFP ë…¼ë¬¸ ë¶„ì„                |   O   |   O   |       |       |       |       |       |       |       |       
| BFP base fixed point ì„¤ê³„   |       |   O   |   O   |   O   |       |       |       |       |       |       
| CBFP ë…¼ë¬¸ ë¶„ì„               |       |       |       |       |   O   |       |       |       |       |       
| CBFP base fixed point ë¶„ì„  |       |       |       |       |    O  |   O   |       |       |       |      
| CBFP base 8-point RTL ì„¤ê³„  |       |       |       |       |       |       |   O   |       |       |       
| Gate simulation & Debugging|       |       |       |       |       |       |      |   O    |       |       
| FPGA targeting             |       |       |       |       |       |       |       |        |  O    |       
| ë°œí‘œ ìë£Œ ì œì‘               |       |       |       |       |       |       |       |     O  |   O   |  



## ğŸ”–ê°œë°œ ê³¼ì •
> ë¹ ë¥¸ ìš”ì•½ì„ ì›í•œë‹¤ë©´ --> [[ë°œí‘œ ìë£Œ]](/History/PPT/Team2_ë°œí‘œìë£Œ.pdf)

## (1) Fixed point modeling [[ê²°ê³¼ ë¶„ì„]](/History/Progress_report/matlab.md)

### â¤ BFP vs CBFP

|<img src="/History/img/img74.png" width=300>|<img src="/History/img/img75.png" width=300>
--|--

### ğŸ“‰ ê¸°ì¡´ ê¸°ë²•: BFP (Block Floating Point)

ğŸ¬  <u>**FFT ì¶œë ¥ ë°ì´í„°**ë¥¼ ë©”ëª¨ë¦¬ì— ì €ì¥í•˜ê¸° ì „ì—, ê·¸ ë¸”ë¡ì˜ ìµœëŒ€ ì§„í­ì„ ê¸°ì¤€ìœ¼ë¡œ **ê³µí†µ ì§€ìˆ˜(exponent)** ë¥¼ ì •í•˜ê³ , í•´ë‹¹ ì§€ìˆ˜ì— ë”°ë¼ ëª¨ë“  ë°ì´í„°ë¥¼ **ìŠ¤ì¼€ì¼ë§**.</u>

ğŸ¬ **ì¥ì :** ì§€ìˆ˜ë¥¼ í•˜ë‚˜ë§Œ ì €ì¥í•˜ë©´ ë˜ë¯€ë¡œ **ë©”ëª¨ë¦¬ ì ˆì•½ ê°€ëŠ¥**.

ğŸ¬ **ë‹¨ì :** ê° ìŠ¤í…Œì´ì§€ì˜ ëª¨ë“  ì—°ì‚° ê²°ê³¼ê°€ ë‚˜ì™€ì•¼ ì§€ìˆ˜ë¥¼ ì •í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ **íŒŒì´í”„ë¼ì¸ êµ¬ì¡°ì—ì„œëŠ” ì‚¬ìš©ì´ ë¶ˆê°€ëŠ¥**.

## 

### ğŸ“ˆ ì œì•ˆëœ ê¸°ë²•: CBFP (Convergent Block Floating Point)

#### â¤ í•µì‹¬ ì•„ì´ë””ì–´:

ğŸ« **ì§€ìˆ˜ë¥¼** í•œ ë¸”ë¡ ì „ì²´ê°€ ì•„ë‹Œ **í•˜ìœ„ ë¸”ë¡ (N/4, N/16 ë“±)** ì— ëŒ€í•´ ë‚˜ëˆ ì„œ ì ìš©.

ğŸ« **íŒŒì´í”„ë¼ì¸ êµ¬ì¡°ì™€ í˜¸í™˜ ê°€ëŠ¥**.

ğŸ« ì´ì „ ìŠ¤í…Œì´ì§€ì˜ ì¼ë¶€ ì¶œë ¥ê°’ë§Œìœ¼ë¡œ ë‹¤ìŒ ìŠ¤í…Œì´ì§€ ì§€ìˆ˜ë¥¼ ê²°ì •í•  ìˆ˜ ìˆìŒ.

##

#### ğŸ“ ì°¸ê³  ë¬¸í—Œ

[1] S. He and M. Torkelson, "A new approach to pipeline FFT processor," in Proc. IEEE International Parallel Processing Symposium (IPPS), Honolulu, HI, USA, Apr. 1996, pp. 766â€“770, doi: 10.1109/IPPS.1996.508098.

[2] Y. W. Lee, J. H. Lee, S. W. Kim, and C. Weems, "A fast single-chip implementation of 8192 complex point FFT," IEEE Journal of Solid-State Circuits, vol. 30, no. 4, pp. 413â€“422, Apr. 1995, doi: 10.1109/4.364645.

##

### âœ³ï¸ ì„±ëŠ¥ í–¥ìƒ

<table style="border-collapse: collapse; border: 3px solid black;" cellpadding="5">
  <!-- SQNR í—¤ë” -->
  <tr style="height:40px;">
    <th rowspan="3" style="background-color:white;"> </th>
    <th colspan="4" style="background-color:#2e5902; color:white; text-align:center;">SQNR(dB)</th>
  </tr>
  <tr style="height:40px;">
    <th colspan="2" style="background-color:#8fcf6d; text-align:center;">FFT</th>
    <th colspan="2" style="background-color:#8fcf6d; text-align:center;">IFFT</th>
  </tr>
  <tr style="height:40px;">
    <th style="text-align:center;">No CBFP</th>
    <th style="text-align:center;">CBFP</th>
    <th style="text-align:center;">No CBFP</th>
    <th style="text-align:center;">CBFP</th>
  </tr>
  <!-- ë°ì´í„° í–‰ -->
  <tr style="height:40px;">
    <td style="text-align:center;"><b>Random</b></td>
    <td style="text-align:center;">26.46 dB</td>
    <td style="text-align:center;">40.84 dB</td>
    <td style="text-align:center;">0.024 dB</td>
    <td style="text-align:center;">44.2 dB</td>
  </tr>
  <tr style="height:40px;">
    <td style="text-align:center;"><b>Cosine</b></td>
    <td style="text-align:center;">41.03 dB</td>
    <td style="text-align:center;">40.83 dB</td>
    <td style="text-align:center;">0.034 dB</td>
    <td style="text-align:center;">41.2 dB</td>
  </tr>
</table>

## (2) RTL Simulation [[ì½”ë“œ ë¶„ì„]](/History/Progress_report/rtl.md)

### ğŸ§ **ì‚¬ìš©ëœ í•˜ë“œì›¨ì–´ ê¸°ë²•**

> ### :one: **íŒŒì´í”„ë¼ì¸ êµ¬ì¡°**  

: FFTì˜ ê° ìŠ¤í…Œì´ì§€ë¥¼ í´ëŸ­ë§ˆë‹¤ ì—°ì†ì ìœ¼ë¡œ ì²˜ë¦¬ ê°€ëŠ¥

> ### :two: **Cooley-Tukey êµ¬ì¡° ìµœì í™”**

: Radix-2Â² êµ¬ì¡° ì‚¬ìš©

â¡ï¸ **Radix-2Â² FFT**ëŠ” **Radix-2ì˜ ë‹¨ìˆœ êµ¬ì¡°**(ë§ì…ˆ/ëº„ì…ˆ ê¸°ë°˜)ë¥¼ ìœ ì§€í•˜ë©´ì„œ, ë‘ ë‹¨ê³„ì˜ ì—°ì‚°ì„ ë¬¶ì–´ **Radix-4**ì²˜ëŸ¼ 4ê°œì”© ì²˜ë¦¬í•˜ì—¬ **ì—°ì‚°ëŸ‰**ì„ ì¤„ì´ê³  ì¼ë¶€ Twiddle factor ê³±ì…ˆì„ ë‹¨ìˆœí™”í•˜ì—¬ í•˜ë“œì›¨ì–´ íš¨ìœ¨ì„ ë†’ì´ëŠ” êµ¬ì¡°

<img src="/History/img/img77.png" width=600>|<div align = "left">âœ…BF I: ë§ì…ˆ/ëº„ì…ˆ ì¤‘ì‹¬ + ë‹¨ìˆœ Twiddle factor (1, -1) <br> â†’ ê³±ì…ˆê¸°ê°€ ê±°ì˜ í•„ìš” ì—†ìŒ <br><br> â˜‘ï¸BF II: ë§ì…ˆ/ëº„ì…ˆ + ì¼ë°˜ Twiddle factor ê³± <br> â†’ ê³±ì…ˆê¸°ê°€ í•„ìš”í•œ ì—°ì‚°ë§Œ ì§‘ì¤‘ <br><br> â¡ï¸ ì¦‰, ë³µì¡í•œ ê³±ì…ˆì„ ìµœì†Œí™”í•˜ê³ , ë‹¨ìˆœ ì—°ì‚°ë§Œ ë”°ë¡œ ì²˜ë¦¬ ê°€ëŠ¥
--|--

- **BF Iì™€ BF IIë¥¼ ë¸”ë¡ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ë©´ HW íš¨ìœ¨ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤.**

  - ë©€í‹°í”Œë¼ì´ì–´ ì‚¬ìš©ëŸ‰ì„ ì¤„ì¼ ìˆ˜ ìˆìŒ

  - ì—°ì‚° íŒŒì´í”„ë¼ì¸ ì„¤ê³„ê°€ ìš©ì´

  - í´ëŸ­ ì‚¬ì´í´ì„ ì ˆì•½ ê°€ëŠ¥

- **ë””ë²„ê¹…ê³¼ ê²€ì¦ ìš©ì´í•˜ë‹¤.**

  - BF I / BF II ë¸”ë¡ êµ¬ë¶„ â†’ ì—°ì‚° ë‹¨ê³„ë¥¼ ëª…í™•íˆ í™•ì¸ ê°€ëŠ¥

  - Fixed-point ë³€í™˜ í›„ ì •í™•ë„ í™•ì¸ì´ ì‰¬ì›€


ğŸ‰ ì¦‰, **BF I / BF II ë¸”ë¡ êµ¬ë¶„** = **ì—°ì‚° ë‹¨ìˆœí™” + í•˜ë“œì›¨ì–´ ìµœì í™” + ë³‘ë ¬í™” ìš©ì´ + ê²€ì¦ í¸ë¦¬ì„±**ì„ ë™ì‹œì— ì–»ëŠ” êµ¬ì¡°
<br>

> **BF I Matlab(add/sub)**

```matlab
% M0 step1 
for kk=1:2
  for nn=1:128
    bfly01_tmp((kk-1)*256+nn) = bfly00((kk-1)*256+nn) + bfly00((kk-1)*256+128+nn);
    bfly01_tmp((kk-1)*256+128+nn) = bfly00((kk-1)*256+nn) - bfly00((kk-1)*256+128+nn);
  end
end
```

> **BF I RTL(add/sub)**

```systemverilog
// M0 step1 
if((step1_shift_type == 1) && step1_add_sub_en) begin
    for(j = 0; j < 16; j++) begin
        add_step01_re_pp_np[j] <= sr128_re_out[j] + bfly00_re_p[j];
        sub_step01_re_pn_nn[j] <= sr128_re_out[j] - bfly00_re_p[j];
        add_step01_im_pp_np[j] <= sr128_im_out[j] + bfly00_im_p[j];
        sub_step01_im_pn_nn[j] <= sr128_im_out[j] - bfly00_im_p[j];
    end
end else if ((step1_shift_type == 3) && step1_add_sub_en) begin
    for (j = 0; j < 16; j++) begin
        add_step01_re_pp_np[j] <= sr128_re_out[j] + sr256_re_out[j];
        sub_step01_re_pn_nn[j] <= sr128_re_out[j] - sr256_re_out[j];
        add_step01_im_pp_np[j] <= sr128_im_out[j] + sr256_im_out[j];
        sub_step01_im_pn_nn[j] <= sr128_im_out[j] - sr256_im_out[j];
    end                
end
```

- Radix-2 ë‹¨ê³„ 2ê°œë¥¼ í•œ ë¸”ë¡ì—ì„œ ì—°ì† ê³„ì‚°
- ì¦‰, ë§ì…ˆ/ëº„ì…ˆì„ í•œ ë¸”ë¡ ì•ˆì—ì„œ í•œ ë²ˆì— ì²˜ë¦¬í•¨ìœ¼ë¡œì¨ stageê°€ ì¤„ê³ , ì¼ë¶€ twiddle factorëŠ” ë‹¨ìˆœ ê³±ì…ˆìœ¼ë¡œ ì²˜ë¦¬ ê°€ëŠ¥ â†’ í•˜ë“œì›¨ì–´ íš¨ìœ¨ â†‘ 

> **BF II Matlab(multiplication)** 

```matlab
% M0 step1 
 fac8_2 = [1, 1, 1, -j, 1, 0.7071-0.7071j, 1, -0.7071-0.7071j]; % floating 
 fac8_1 = round(fac8_2 * 256); % fixed <2.8>

 for nn=1:512
	temp_bfly01(nn) = bfly01_tmp(nn)*fac8_1(ceil(nn/64));  %INPUT <5.6> X <2.8> -> OUTPUT <7.14>
	bfly01(nn) = round(temp_bfly01(nn)/256); % <7.6>
 end
```

| nn ë²”ìœ„           | 1\~64 | 65\~128 | 129\~192 | 193\~256 | 257\~320 | 321\~384       | 385\~448 | 449\~512        |
| ---------------- | ----- | ------- | -------- | -------- | -------- | -------------- | -------- | --------------- |
| ceil(nn/64)      | 1     | 2       | 3        | 4        | 5        | 6              | 7        | 8               |
| factor (fac8\_1) | 1     | 1       | 1        | -j       | 1        | 0.7071-0.7071j | 1        | -0.7071-0.7071j |



> **BF II RTL(multiplication)**

```systemverilog
// M0 step1 
if(step1_mul_en) begin // twf factor multiply <5.6> * <1.8> = <6.14>
  index_cnt <= index_cnt + 1;
  if(index_cnt < 4) begin
      for(j = 0; j < 16; j++) begin
          bfly01_re_p[j] <= ((add_step01_re_pp_np[j] <<< 8) + 128) >>> 8;
          bfly01_re_n[j] <= ((sub_step01_re_pn_nn[j] <<< 8) + 128) >>> 8;
          bfly01_im_p[j] <= ((add_step01_im_pp_np[j] <<< 8) + 128) >>> 8;
          bfly01_im_n[j] <= ((sub_step01_im_pn_nn[j] <<< 8) + 128) >>> 8;
      end
  end else if(index_cnt < 8) begin
      for(j = 0; j < 16; j++) begin
          bfly01_re_p[j] <= ((add_step01_re_pp_np[j] <<< 8) + 128) >>> 8;
          bfly01_re_n[j] <= ((sub_step01_im_pn_nn[j] <<< 8) + 128) >>> 8;
          bfly01_im_p[j] <= ((add_step01_im_pp_np[j] <<< 8) + 128) >>> 8;
          bfly01_im_n[j] <= (-(sub_step01_re_pn_nn[j] <<< 8) + 128) >>> 8;
      end
  end else if(index_cnt < 12) begin
      for(j = 0; j < 16; j++) begin
          bfly01_re_p[j] <= ((add_step01_re_pp_np[j] <<< 8) + 128) >>> 8;
          bfly01_re_n[j] <= ((sub_step01_re_pn_nn[j] <<< 8) + 128) >>> 8;
          bfly01_im_p[j] <= ((add_step01_im_pp_np[j] <<< 8) + 128) >>> 8;
          bfly01_im_n[j] <= ((sub_step01_im_pn_nn[j] <<< 8) + 128) >>> 8;
      end
  end else if(index_cnt < 16) begin
      for(j = 0; j < 16; j++) begin
          bfly01_re_p[j] <= (mul181(add_step01_re_pp_np[j]) + mul181(add_step01_im_pp_np[j]) + 128) >>> 8;
          bfly01_re_n[j] <= (mul_neg181(sub_step01_re_pn_nn[j]) + mul181(sub_step01_im_pn_nn[j]) + 128) >>> 8;
          bfly01_im_p[j] <= (mul181(add_step01_im_pp_np[j]) - mul181(add_step01_re_pp_np[j]) + 128) >>> 8;
          bfly01_im_n[j] <= (mul_neg181(sub_step01_im_pn_nn[j]) - mul181(sub_step01_re_pn_nn[j]) + 128) >>> 8;
      end
  end
end
```

- BF II ì—°ì‚°ì„ index_cnt ê¸°ì¤€ ë¸”ë¡í™” â†’ ê³±ì…ˆ ìµœì í™”

- re_p/im_p, re_n/im_n ë¸”ë¡ êµ¬ë¶„ â†’ ë³‘ë ¬í™” ìš©ì´



| nn ë²”ìœ„         | 1\~64                      | 65\~128                    | 129\~192                   | 193\~256                   | 257\~320                   | 321\~384                   | 385\~448                   | 449\~512                   |
| ------------- | -------------------------- | -------------------------- | -------------------------- | -------------------------- | -------------------------- | -------------------------- | -------------------------- | -------------------------- |
| **index\_cnt ë²”ìœ„** | 0\~3                       | 4\~7                       | 0\~3                       | 4\~7                       | 8\~11                      | 12\~15                     | 8\~11                      | 12\~15                     |
| **ë°ì´í„° <br>ê·¸ë£¹**    | re\_p\[0:63], im\_p\[0:63] | re\_p\[0:63], im\_p\[0:63] | re\_n\[0:63], im\_n\[0:63] | re\_n\[0:63], im\_n\[0:63] | re\_p\[0:63], im\_p\[0:63] | re\_p\[0:63], im\_p\[0:63] | re\_n\[0:63], im\_n\[0:63] | re\_n\[0:63], im\_n\[0:63] |



|<img src="/History/img/img86.png" width=1000>|
|--|


> ### :three: **ê³ ì • ì†Œìˆ˜ì  ì‚¬ìš©**  

: ë¶€ë™ì†Œìˆ˜ì  ëŒ€ë¹„ ë©´ì /ì „ë ¥ ì ˆê° + Precision trade-off ê°€ëŠ¥

â¡ï¸ **BFP**ëŠ” ë¸”ë¡ ë‹¨ìœ„ë¡œ **ê³µí†µ ìŠ¤ì¼€ì¼**ì„ ì‚¬ìš©í•˜ëŠ” ë°˜ë©´, **CBFP**ëŠ” **ë¸”ë¡** ë‚´ ì‘ì€ ê°’ë“¤ì˜ ì—¬ìœ  ë¹„íŠ¸ë¥¼ í™œìš©í•´ **Q-formatì„ ì¡°ì •**í•¨ìœ¼ë¡œì¨ **ë¼ìš´ë”© ì˜¤ì°¨ë¥¼ ì¤„ì´ê³  ì •ë°€ë„ í–¥ìƒ**ì´ ê°€ëŠ¥

> **CBFP Matlab(ì¼ë¶€)**

```matlab
% M0 CBFP
for ii=1:8
  for jj=1:64
	tmp1_re = mag_detect(real(pre_bfly02(64*(ii-1)+jj)), 23);
	tmp1_im = mag_detect(imag(pre_bfly02(64*(ii-1)+jj)), 23);
```

* mag_detect: Twiddle factor ê³± ì´í›„ì˜ ë³µì†Œìˆ˜ FFT ê²°ê³¼ë¥¼ ì´ì§„ìˆ˜ë¡œ ë³€í™˜í•´ ê° ë°ì´í„°ê°€ MSBë¶€í„° ë¶€í˜¸ ë¹„íŠ¸(0 or 1)ê°€ ì–¼ë§ˆë‚˜ ì—°ì†ë˜ëŠ”ì§€ ê³„ì‚°
* ì •ê·œí™” ì˜¤ë²„í”Œë¡œìš° ê°€ëŠ¥ì„±ì„ ê³ ë ¤í•´ CBFP ì—°ì‚° ì§ì „ì— ë¶€í˜¸ ë¹„íŠ¸ ì¶”ê°€

```matlab
% MO CBFP
	temp1_re = min_detect(jj, tmp1_re, cnt1_re(ii));
	temp1_im = min_detect(jj, tmp1_im, cnt1_im(ii));
```
* min_detect: 64ê°œì˜ ë°ì´í„° ì¤‘ mag_detect ê²°ê³¼ê°€ ê°€ì¥ ì‘ì€ ê°’ ì„ íƒ
* ê° ë¸”ë¡(64ê°œ ë‹¨ìœ„)ë§ˆë‹¤ ìµœëŒ€í•œ ì•ˆì „í•˜ê²Œ Shift í•  ìˆ˜ ìˆëŠ” í­ì„ ê³„ì‚°í•´, í•´ë‹¹ ë¹„íŠ¸ ìˆ˜ë§Œí¼ ì „ë¶€ ì •ê·œí™”(bit shift)í•œë‹¤.

> **CBFP RTL(ì¼ë¶€)**


```systemverilog
// M0 CBFP 
always_comb begin
    lzc_re = count_min_lzc_23bit(din_re);
    lzc_im = count_min_lzc_23bit(din_im);
end
always_ff @( posedge clk or negedge rstn ) begin
    if (!rstn) begin
        for (int i = 0; i < array_num; i=i+1) begin
            cal_cnt[i] <= '0;
        end
    end else if (valid_in) begin
        for (int i = array_num - 1; i > 0; i=i-1) begin
            cal_cnt[i] <= cal_cnt[i-1];
        end 
        
        cal_cnt[0] <= (lzc_re > lzc_im) ? lzc_im : lzc_re;
    end else begin
        for (int i = 0; i < array_num; i=i+1) begin
            cal_cnt[i] <= cal_cnt[i];
        end
    end
end
```

* **count_min_lzc_23bit** í•¨ìˆ˜ë¡œ 16ê°œ ë°ì´í„°ì˜ **mag_detectë¥¼ ê³„ì‚°**í•˜ë©° **ì‹¤ì‹œê°„**ìœ¼ë¡œ **ìµœì†Ÿê°’**ì„ êµ¬í•¨ <br>â†’ ì—°ì‚° ëª¨ë“ˆ ì™„ë£Œ í›„ ë‹¤ìŒ clkì—ì„œì˜ ë¹„êµ ëŒ€ìƒ ë°ì´í„°ë¥¼ **64ê°œì—ì„œ 4ê°œë¡œ** ì¤„ì—¬ Timing Margin í™•ë³´ <br>â†’ ë¹„êµ ì—°ì‚° ëª¨ë“ˆì˜ ì¬í™œìš© :arrow_right: ë©´ì  ê°ì†Œ ë° ìì› ì ˆì•½

|<img src="/History/img/img101.png" width=1000>|
|--|


> ### :four: **LUT ì‚¬ìš©**  

: twiddle factorë¥¼ ROMì— ë¯¸ë¦¬ ì €ì¥í•˜ì—¬ ê³±ì…ˆ ë¹„ìš© ì ˆê°

### ğŸ˜ RTL Simulation

### âœ… Cosine_Input

|<img src="/History/img/img88.png" width=1000>|
|--|

#### â¡ï¸ [Matlab] First 32 Input Data Points


| Real | 63 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 63 | 63 | 63 | 63 | 63 | 63 | 63 | 62 | 62 | 62 | 62 | 62 | 61 | 61 | 61 | 61 | 61 | 60 | 60 | 60 | 59 | Â·Â·Â· |
|------|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|
| **IMG** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **Â·Â·Â·** |


|<img src="/History/img/img89.png" width=1000>|
|--|

#### â¡ï¸[Matlab] Last 32 Input Data Points


| Real | Â·Â·Â· | 59 | 59 | 60 | 60 | 60 | 61 | 61 | 61 | 61 | 61 | 62 | 62 | 62 | 62 | 62 | 63 | 63 | 63 | 63 | 63 | 63 | 63 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 |
|------|-----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|
| **IMG** | **Â·Â·Â·** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** |



### âœ… Cosine_Output

|<img src="/History/img/img90.png" width=1000>|
|--|

#### â¡ï¸[Matlab] First 32 Output Data Points

| Real | -1 | 4091 | -1 | 2 | -1 | 2 | -1 | -3 | -1 | -4 | -1 | -1 | -1 | 3 | -1 | 3 | -1 | -1 | -1 | -1 | -1 | -2 | -1 | 2 | -1 | -1 | -1 | -4 | -1 | -1 | -1 | 0 | Â·Â·Â· |
|------|----|------|----|---|----|---|----|----|----|----|----|----|----|---|----|---|----|----|----|----|----|----|----|---|----|---|----|----|----|----|----|----|----|
| **IMG** | **0** | **-6** | **0** | **-1** | **0** | **-1** | **0** | **-4** | **0** | **0** | **0** | **-1** | **0** | **-1** | **0** | **1** | **0** | **0** | **0** | **-1** | **0** | **-1** | **0** | **-1** | **0** | **0** | **0** | **-1** | **0** | **0** | **0** | **0** | Â·Â·Â· |



|<img src="/History/img/img91.png" width=1000>|
|--|

#### â¡ï¸ [Matlab] Last 32 Output Data Points


| Real | Â·Â·Â· | -1 | 1 | -1 | -1 | -1 | -4 | -1 | -1 | -1 | -1 | -1 | -2 | -1 | -1 | -1 | -1 | -1 | 3 | -1 | 3 | -1 | -1 | -1 | -5 | -1 | 2 | -1 | 2 | -1 | 2 | -1 | 4091 |
|------|-----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|---|----|---|----|---|----|----|----|----|----|----|----|----|----|----|------|
| **Imag** |  **Â·Â·Â·** | **0** | **1** | **0** | **-1** | **0** | **0** | **0** | **-2** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **-1** | **0** | **-1** | **0** | **0** | **0** | **0** | **0** | **2** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** |



ğŸ‰ Matlabì„ í†µí•´ ì˜ˆì¸¡í•œ ê²°ê³¼ì™€ ê°™ìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  <br>
â˜‘ï¸ FPGAì™€ ì—°ê²°í•˜ê¸° ìœ„í•´ Cosine Inputì„ 8clk ì‰¬ê³  ë‹¤ì‹œ ë°˜ë³µí•˜ë„ë¡ ì„¤ê³„í•˜ì—¬ ì¶œë ¥ì´ ì§„í–‰ë  ë•Œë„ Input Dataê°€ ì…ë ¥ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

## (3) Synthesis

|Setup_time| Area|
--|--|
|<div align = "middle"> 0.14 ps|<div align = "middle"> 187768.2|


Timing_max| Area
--|--
|<img src="/History/img/img70.png" width=400>| <img src="/History/img/img72.png" width=400>|

> Hold timeì€ Layout ë‹¨ê³„ì—ì„œ ì¶©ë¶„íˆ í•´ê²° ê°€ëŠ¥í•˜ë¯€ë¡œ front-end ê³¼ì •ì—ì„œëŠ” Setup timeê³¼ Area ìµœì í™”ì— ì§‘ì¤‘í•˜ì˜€ë‹¤.

## (4) Gate Simulation [[ê²°ê³¼ ë¶„ì„]](/History/Progress_report/gate.md)

### ğŸ” TestBench: Vectorization / Flattening

```systemverilog
logic signed [0:143] din_re;
logic signed [0:143] din_im;
logic [0:207] dout_re;  
logic [0:207] dout_im;
```

#### ğŸ¤” ë‹¤ì°¨ì› ë°°ì—´ì„ 1ì°¨ì› ë²¡í„°ë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì˜ í•„ìš”ì„±

:one: **ê²Œì´íŠ¸ ì‹œë®¬ë ˆì´ì…˜ì—ì„œ ë°°ì—´ ì œí•œ:** 
- ì¼ë¶€ EDA íˆ´ì´ë‚˜ í•©ì„±ëœ netlistëŠ” ë°°ì—´ì„ ì§ì ‘ ì‹œë®¬ë ˆì´ì…˜í•  ìˆ˜ ì—†ìŒ.
 
:two: **ë°°ì„  ë‹¨ìˆœí™”:** 
- ëª¨ë“  ìš”ì†Œë¥¼ í•˜ë‚˜ì˜ ì—°ì†ëœ vectorë¡œ ë°”ê¾¸ë©´, ëª¨ë“ˆ ê°„ ì—°ê²°ì´ ê°„ë‹¨í•´ì§.

:three: **ìë™í™” ê°€ëŠ¥:** 
- Testbenchì—ì„œ ë°˜ë³µë¬¸ìœ¼ë¡œ ë°°ì—´ì„ ì±„ìš°ë˜ ë¡œì§ì„ ë²¡í„° ìŠ¬ë¼ì´ìŠ¤ë¡œ ì²˜ë¦¬ ê°€ëŠ¥.


```systemverilog
logic signed [8:0] din_re_arr [0:15];
logic signed [8:0] din_im_arr [0:15];
logic signed [12:0] dout_re_arr [0:15];
logic signed [12:0] dout_im_arr [0:15];
```

- ì‚¬ìš©ìì˜ í¸ì˜ë¥¼ ìœ„í•´ RTL ë°°ì—´ë¥¼ ì¶”ê°€í•˜ì—¬ Waveformì—ì„œì˜ ê°€ë…ì„±ì„ ë†’ì˜€ë‹¤.

##

### ğŸ˜ Gate Simulation

### â˜‘ï¸ Latency: 89clk

|<img src="/History/img/img92.png" width=600>|
|--|

|Input: 32 clk(32 x 16 = 512 points)  |Output: 32 clk(32 x 16 = 512 points) |
|--|--|
|<img src="/History/img/img93.png" width=500>|<img src="/History/img/img94.png" width=500>|


### âœ… Cosine_Input

|<img src="/History/img/img95.png" width=1000>|
|--|

#### â¡ï¸ [Matlab] First 32 Input Data Points


| Real | 63 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 63 | 63 | 63 | 63 | 63 | 63 | 63 | 62 | 62 | 62 | 62 | 62 | 61 | 61 | 61 | 61 | 61 | 60 | 60 | 60 | 59 | Â·Â·Â· |
|------|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|
| **IMG** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **Â·Â·Â·** |


|<img src="/History/img/img96.png" width=1000>|
|--|

#### â¡ï¸[Matlab] Last 32 Input Data Points


| Real | Â·Â·Â· | 59 | 59 | 60 | 60 | 60 | 61 | 61 | 61 | 61 | 61 | 62 | 62 | 62 | 62 | 62 | 63 | 63 | 63 | 63 | 63 | 63 | 63 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 |
|------|-----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|
| **IMG** | **Â·Â·Â·** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** |



### âœ… Cosine_Output

|<img src="/History/img/img97.png" width=1000>|
|--|

#### â¡ï¸[Matlab] First 32 Output Data Points

| Real | -1 | 4091 | -1 | 2 | -1 | 2 | -1 | -3 | -1 | -4 | -1 | -1 | -1 | 3 | -1 | 3 | -1 | -1 | -1 | -1 | -1 | -2 | -1 | 2 | -1 | -1 | -1 | -4 | -1 | -1 | -1 | 0 | Â·Â·Â· |
|------|----|------|----|---|----|---|----|----|----|----|----|----|----|---|----|---|----|----|----|----|----|----|----|---|----|---|----|----|----|----|----|----|----|
| **IMG** | **0** | **-6** | **0** | **-1** | **0** | **-1** | **0** | **-4** | **0** | **0** | **0** | **-1** | **0** | **-1** | **0** | **1** | **0** | **0** | **0** | **-1** | **0** | **-1** | **0** | **-1** | **0** | **0** | **0** | **-1** | **0** | **0** | **0** | **0** | Â·Â·Â· |



|<img src="/History/img/img98.png" width=1000>|
|--|

#### â¡ï¸ [Matlab] Last 32 Output Data Points


| Real | Â·Â·Â· | -1 | 1 | -1 | -1 | -1 | -4 | -1 | -1 | -1 | -1 | -1 | -2 | -1 | -1 | -1 | -1 | -1 | 3 | -1 | 3 | -1 | -1 | -1 | -5 | -1 | 2 | -1 | 2 | -1 | 2 | -1 | 4091 |
|------|-----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|---|----|---|----|---|----|----|----|----|----|----|----|----|----|----|------|
| **Imag** |  **Â·Â·Â·** | **0** | **1** | **0** | **-1** | **0** | **0** | **0** | **-2** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **-1** | **0** | **-1** | **0** | **0** | **0** | **0** | **0** | **2** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** | **0** |


## (5) FPGA Targeting [[ê²°ê³¼ ë¶„ì„]](/History/Progress_report/fpga.md)

|LUT|Setup-time|Latency|power
--|--|--|--|
|<div align = "middle">65538 (30%)| <div align = "middle"> 0.576 ns|<div align = "middle"> 89 clk|<div align = "middle"> 1.74 W|

<img src="/History/img/img79.png" width=400> |<img src="/History/img/img84.png" width=400> |
--|--

<img src="/History/img/img80.png" width=400> |<img src="/History/img/img82.png" width=200>|<img src="/History/img/img83.png" width=200>|
--|--|--


- LUT 30% ì‚¬ìš© -> Combinational Logic â†‘
- FF, DSP ì•½ 10% -> ì ì • Pipelining, Multiplier
- Setup Time & Hold Time Slack MET 

## ì§„í–‰ ê²°ê³¼

<table border="1" cellspacing="0" cellpadding="5">
  <thead>
    <tr>
      <th>êµ¬ë¶„</th>
      <th>ê²€ì¦ í•­ëª©</th>
      <th>ê²€ì¦ ìš”ì†Œ</th>
      <th>ì™„ë£Œ ì—¬ë¶€</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="3">ASIC (500MHz)</td>
      <td>RTL Simulation</td>
      <td>Cosine, Random Fixed Data</td>
      <td align="center">â—‹</td>
    </tr>
    <tr>
      <td>Synthesis</td>
      <td>Setup Violation, Area</td>
      <td align="center">â—‹</td>
    </tr>
    <tr>
      <td>Gate Simulation</td>
      <td>Cosine, Random Fixed Data</td>
      <td align="center">â—‹</td>
    </tr>
    <tr>
      <td rowspan="3">FPGA (100MHz)</td>
      <td>FPGA top Block</td>
      <td>Cosine generator, FFT, VIO</td>
      <td align="center">â—‹</td>
    </tr>
    <tr>
      <td>RTL Simulation</td>
      <td>Cosine Fixed Data</td>
      <td align="center">â—‹</td>
    </tr>
    <tr>
      <td>Synthesis & Implementation</td>
      <td>Setup Violation, Utilization, Bitstream</td>
      <td align="center">â—‹</td>
    </tr>
  </tbody>
</table>


## ğŸš€Trouble Shooting 
[âš’ï¸[Timing Miss Match Trouble]](/History/trouble_shooting/Trouble_Shooting1.md)   <br>
[âš’ï¸[Random Input Trouble]](/History/trouble_shooting/Trouble_Shooting2.md)  <br>
[âš’ï¸[Clock-gate Latch]](/History/trouble_shooting/Trouble_Shooting3.md) <br>
[âš’ï¸[Indexsum Problem]](/History/trouble_shooting/Trouble_Shooting4.md) <br>
[âš’ï¸[Vivado Synthesis Error]](/History/trouble_shooting/Trouble_Shooting5.md)       <br>
[âš’ï¸[GateSim Trouble]](/History/trouble_shooting/Trouble_Shooting6.md)       <br>
[âš’ï¸[FPGA SetUp Trouble]](/History/trouble_shooting/Trouble_Shooting7.md)      <br>
[âš’ï¸[ë” ì‘ì„±í•  ë‚´ìš© ìˆìœ¼ë©´ ì¶”ê°€]](/History/trouble_shooting/Trouble_Shooting8.md)      <br>

